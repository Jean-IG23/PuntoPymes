# ğŸ“Š JERARQUÃA DE ROLES - CASOS DE USO PRÃCTICOS

## ğŸ¯ Esquema Visual de JerarquÃ­a

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”´ SUPERADMIN (Nivel 5)                                        â”‚
â”‚  â”œâ”€ Owner de la Plataforma SaaS                                 â”‚
â”‚  â”œâ”€ Acceso Total sin Restricciones                              â”‚
â”‚  â””â”€ Puede gestionar mÃºltiples empresas clientes                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŸ  ADMIN (Nivel 4)                                             â”‚
â”‚  â”œâ”€ Cliente/DueÃ±o de la Empresa                                 â”‚
â”‚  â”œâ”€ Administrador Total de su Empresa                           â”‚
â”‚  â””â”€ Puede delegar a RRHH y Gerentes                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†™â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†–
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ğŸŸ¡ RRHH (Nivel 3)          â”‚   â”‚  ğŸŸ¢ GERENTE (Nivel 2)â”‚
    â”‚  â”œâ”€ GestiÃ³n de RRHH         â”‚   â”‚  â”œâ”€ LÃ­der de Ãrea    â”‚
    â”‚  â”œâ”€ NÃ³mina                  â”‚   â”‚  â”œâ”€ SupervisiÃ³n      â”‚
    â”‚  â””â”€ Empleados               â”‚   â”‚  â””â”€ Equipo           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†™â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†–
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ğŸ”µ EMPLEADO (Nivel 1)                                   â”‚
    â”‚  â”œâ”€ Colaborador                                          â”‚
    â”‚  â”œâ”€ Solo datos propios                                   â”‚
    â”‚  â””â”€ Tareas y Asistencia personal                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ TABLA COMPARATIVA RÃPIDA

| AcciÃ³n | SUPERADMIN | ADMIN | RRHH | GERENTE | EMPLEADO |
|--------|:----------:|:-----:|:----:|:-------:|:--------:|
| **Dashboard KPI** | âœ… | âœ… | âœ… | âŒ | âŒ |
| **Crear Empleado** | âœ… | âœ… | âœ… | âŒ | âŒ |
| **Editar ConfiguraciÃ³n** | âœ… | âœ… | âœ… | âŒ | âŒ |
| **Ver Asistencia General** | âœ… | âœ… | âœ… | âœ…* | âŒ |
| **Aprobar Tareas** | âœ… | âœ… | âœ… | âœ…* | âŒ |
| **Aprobar Ausencias** | âœ… | âœ… | âœ… | âœ…* | âŒ |
| **Crear Tareas** | âœ… | âœ… | âœ… | âœ… | âŒ |
| **Ver Tareas Asignadas** | âœ… | âœ… | âœ… | âœ…* | âœ…** |
| **Marcar Asistencia** | âœ… | âœ… | âœ… | âœ… | âœ… |
| **Ver NÃ³mina Propia** | âœ… | âœ… | âœ… | âœ… | âœ… |

*Solo de su equipo/sucursal  
**Solo las propias

---

## ğŸ” CASOS DE USO DETALLADOS

### CASO 1: Mateo (SUPERADMIN)

```
Rol: SUPERADMIN
Empresa: Todas
Acceso: Global

Puede hacer:
  âœ… Crear nueva empresa cliente
  âœ… Asignar licencias SaaS
  âœ… Ver dashboard de ALL empresas
  âœ… Ver nÃ³mina de cualquier empleado
  âœ… Auditar cualquier acciÃ³n en el sistema
  âœ… Crear/editar/eliminar usuarios
  âœ… Ver reportes consolidados

Casos de uso:
  â€¢ Crear una nueva empresa: "Tienda ABC S.A."
    - Crear empresa
    - Crear usuario admin (email: admin@abcstore.com)
    - Crear sucursal matriz
    
  â€¢ Monitorear salud de clientes
    - Ver dashboard multi-empresa
    - Validar licencias activas
    - Resolver problemas tÃ©cnicos
```

---

### CASO 2: Juan (ADMIN - DueÃ±o de Tienda ABC)

```
Rol: ADMIN
Empresa: Tienda ABC S.A.
Alcance: 1 empresa, mÃºltiples sucursales

Puede hacer:
  âœ… Contratar empleados
  âœ… Crear sucursales
  âœ… Crear departamentos
  âœ… Configurar nÃ³mina
  âœ… Ver asistencia de todos
  âœ… Aprobar vacaciones/ausencias
  âœ… Crear tareas y aprobarlas
  âœ… Ver reportes de su empresa

No puede hacer:
  âŒ Crear otra empresa
  âŒ Ver datos de otras empresas
  âŒ Gestionar licencias

Casos de uso:
  â€¢ Contratar nuevo empleado
    - Crear empleado con rol EMPLEADO
    - Asignar sucursal y departamento
    - Sistema envÃ­a credenciales
    
  â€¢ Abrir nueva sucursal
    - Crear sucursal "Centro"
    - Crear departamentos en esa sucursal
    - Asignar gerente para esa sucursal
    
  â€¢ Configurar nÃ³mina
    - Editar valores base (AFP, ISAPRE, etc)
    - Aplicar a toda la empresa
```

---

### CASO 3: MarÃ­a (RRHH)

```
Rol: RRHH
Empresa: Tienda ABC S.A.
Alcance: 1 empresa completa (mismo que ADMIN pero sin config)

Puede hacer:
  âœ… Crear/editar empleados
  âœ… Crear tipos de ausencia
  âœ… Ver configuraciÃ³n de nÃ³mina
  âœ… Procesar ausencias/vacaciones
  âœ… Crear y asignar tareas
  âœ… Aprobar tareas del equipo
  âœ… Importar empleados en lote

No puede hacer:
  âŒ Editar empresa/sucursal
  âŒ Ver/editar nÃ³mina
  âŒ Crear nuevas configuraciones

Casos de uso:
  â€¢ Procesar vacaciones
    - Empleado solicita 15 dÃ­as
    - MarÃ­a valida saldo
    - MarÃ­a aprueba/rechaza
    - Sistema actualiza saldo
    
  â€¢ Importar 50 empleados
    - Descarga plantilla Excel
    - Carga datos de todos
    - Sistema crea automÃ¡ticamente
    - EnvÃ­a credenciales a todos
    
  â€¢ Crear tipos de ausencia
    - AÃ±ade "Licencia por Enfermedad"
    - Configura duraciÃ³n mÃ¡xima
    - Los empleados pueden usarla
```

---

### CASO 4: Carlos (GERENTE - Jefe de Ventas)

```
Rol: GERENTE
Empresa: Tienda ABC S.A.
Sucursal: Sucursal Centro
Equipo: 15 empleados en Ventas

Puede ver/hacer:
  âœ… Listar empleados de su sucursal
  âœ… Ver asistencia de su equipo (no empresa entera)
  âœ… Crear tareas para su equipo
  âœ… Aprobar/rechazar tareas del equipo
  âœ… Aprobar ausencias del equipo (15 dÃ­as max)
  âœ… Ver productividad de su Ã¡rea
  âœ… Marcar su propia asistencia

No puede ver/hacer:
  âŒ Empleados de otras sucursales
  âŒ NÃ³mina
  âŒ Crear empleados
  âŒ Editar configuraciÃ³n
  âŒ Tareas creadas por RRHH (solo las suyas)

Casos de uso:
  â€¢ Supervisar equipo
    - Ve 15 empleados de su sucursal
    - Crea tarea: "Vender 100 artÃ­culos"
    - Asigna a 3 mejores vendedores
    - Aprueba cuando completen
    
  â€¢ Aprobar ausencia
    - Empleado solicita ausentarse viernes
    - Carlos ve la solicitud (solo su equipo)
    - Aprueba si tiene cobertura
    - Rechaza si necesita ese dÃ­a
    
  â€¢ Seguimiento diario
    - Ve grÃ¡fico de asistencia (su sucursal)
    - Ve ranking de vendedores
    - Identifica empleados con problemas
```

---

### CASO 5: Pedro (EMPLEADO - Vendedor)

```
Rol: EMPLEADO
Empresa: Tienda ABC S.A.
Sucursal: Centro
Equipo: Ventas (bajo Carlos)

Puede ver/hacer:
  âœ… Marcar entrada/salida
  âœ… Ver su propia asistencia
  âœ… Ver tareas asignadas
  âœ… Completar sus tareas
  âœ… Solicitar ausencias
  âœ… Ver su nÃ³mina
  âœ… Completar sus objetivos

No puede ver/hacer:
  âŒ Empleados de otra sucursal
  âŒ Tareas de otros vendedores
  âŒ Asistencia de otros
  âŒ NÃ³mina de otros
  âŒ Crear o editar configuraciones

Casos de uso:
  â€¢ DÃ­a laboral tÃ­pico
    - Llega a tienda: "Marcar entrada" (09:00)
    - Ve 3 tareas asignadas por Carlos
    - Completa venta: "Marcar tarea como hecha"
    - Sale: "Marcar salida" (18:00)
    - Sistema registra 9 horas
    
  â€¢ Solicitar vacaciones
    - Solicita 5 dÃ­as en Diciembre
    - Carlos ve la solicitud
    - Carlos aprueba
    - Sistema actualiza su saldo
    
  â€¢ Consultar su desempeÃ±o
    - Ve grÃ¡fico de tareas completadas
    - Ve objetivos mensuales
    - Ve posiciÃ³n en ranking (si existe)
```

---

## ğŸ” REGLAS DE ACCESO A DATOS

### Regla 1: Filtrado por Empresa
```
SUPERADMIN â†’ Todas las empresas
ADMIN      â†’ Su empresa solamente
RRHH       â†’ Su empresa solamente
GERENTE    â†’ Su sucursal solamente
EMPLEADO   â†’ Solo sus datos
```

### Regla 2: Filtrado por Sucursal
```
SUPERADMIN â†’ Todas las sucursales
ADMIN      â†’ Todas las sucursales de su empresa
RRHH       â†’ Todas las sucursales de su empresa
GERENTE    â†’ Solo su sucursal asignada
EMPLEADO   â†’ Solo su sucursal asignada
```

### Regla 3: Filtrado por Usuario
```
SUPERADMIN â†’ Todos los datos
ADMIN      â†’ Todos en su empresa
RRHH       â†’ Todos en su empresa
GERENTE    â†’ Equipo en su sucursal
EMPLEADO   â†’ Solo los propios
```

---

## ğŸš€ EJEMPLOS DE LLAMADAS A API

### âœ… PERMITIDO: ADMIN ve empleados de su empresa
```
GET /api/empleados/?empresa=1
Resultado: Todos los empleados de empresa 1
```

### âŒ DENEGADO: ADMIN intenta ver empresa diferente
```
GET /api/empleados/?empresa=2
Resultado: 403 Forbidden - "No tienes acceso a esa empresa"
```

### âœ… PERMITIDO: GERENTE crea tarea
```
POST /api/tareas/
Body: { titulo: "Vender 10 items", asignado_a: 5 }
Resultado: 201 Created - Tarea creada
```

### âŒ DENEGADO: EMPLEADO intenta crear tarea
```
POST /api/tareas/
Body: { titulo: "...", asignado_a: 5 }
Resultado: 403 Forbidden - "Solo ADMIN, RRHH, GERENTE pueden crear tareas"
```

### âœ… PERMITIDO: RRHH aprueba ausencia
```
POST /api/ausencias/123/aprobar/
Resultado: 200 OK - Ausencia aprobada
```

### âŒ DENEGADO: GERENTE aprueba ausencia fuera de su equipo
```
POST /api/ausencias/456/aprobar/  (empleado de otra sucursal)
Resultado: 403 Forbidden - "Solo puedes aprobar ausencias de tu equipo"
```

---

## ğŸ“± VISIBILIDAD EN FRONTEND

### Dashboard (Home)
```
SUPERADMIN â†’ Ve mÃ³dulos SaaS + todos los mÃ³dulos
ADMIN      â†’ Ve Dashboard Admin + GestiÃ³n
RRHH       â†’ Ve Dashboard RRHH + GestiÃ³n Personal
GERENTE    â†’ Ve Dashboard Gerente + Tareas
EMPLEADO   â†’ Ve Reloj Digital + Mis Tareas
```

### MenÃº de NavegaciÃ³n
```
SUPERADMIN:
  â”œâ”€ SaaS
  â”‚  â”œâ”€ Empresas
  â”‚  â””â”€ Licencias
  â”œâ”€ Gestion
  â”‚  â”œâ”€ Personal
  â”‚  â””â”€ Configuracion
  â””â”€ Dashboard

ADMIN:
  â”œâ”€ Gestion
  â”‚  â”œâ”€ Personal
  â”‚  â”œâ”€ Configuracion
  â”‚  â”œâ”€ Tareas
  â”‚  â””â”€ Ausencias
  â””â”€ Dashboard

RRHH:
  â”œâ”€ Personal
  â”œâ”€ Tareas
  â”œâ”€ NÃ³mina
  â””â”€ Dashboard

GERENTE:
  â”œâ”€ Mi Equipo
  â”œâ”€ Tareas
  â””â”€ Dashboard

EMPLEADO:
  â”œâ”€ Reloj
  â”œâ”€ Mis Tareas
  â””â”€ Mi Asistencia
```

---

## âœ… VALIDACIÃ“N DE IMPLEMENTACIÃ“N

Para cada mÃ³dulo/endpoint, verificar:

- [ ] Â¿QuiÃ©n deberÃ­a tener acceso?
- [ ] Â¿QuÃ© datos ve cada rol?
- [ ] Â¿QuÃ© acciones puede hacer?
- [ ] Â¿CÃ³mo se filtran los datos?
- [ ] Â¿Hay excepciones por sucursal/equipo?
- [ ] Â¿EstÃ¡ documentado el caso de uso?

---

## ğŸ”„ FLUJO DE VERIFICACIÃ“N

```
Solicitud llega â†’ Â¿Es SuperUser? 
                   â”œâ”€ SÃ â†’ Permitir todo
                   â””â”€ NO â†’ Obtener empleado
                           Â¿Rol en lista permitida?
                           â”œâ”€ SÃ â†’ Filtrar datos segÃºn rol
                           â””â”€ NO â†’ 403 Forbidden
```
