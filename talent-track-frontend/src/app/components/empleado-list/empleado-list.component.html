<div class="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
  
  <div class="mb-8 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
    <div>
      <h1 class="text-2xl font-bold text-gray-900 tracking-tight">Directorio de Personal</h1>
      <p class="text-sm text-gray-500 mt-1">Gestiona la nómina, roles y accesos de tu empresa.</p>
    </div>
    
    <div class="flex flex-wrap gap-3">
      <button routerLink="/carga-masiva" class="inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
        <i class="bi bi-file-earmark-spreadsheet text-green-600 mr-2"></i> Importar Excel
      </button>
      
      <button (click)="abrirModalCrear()" class="inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
        <i class="bi bi-plus-lg mr-2"></i> Nuevo Empleado
      </button>
    </div>
  </div>

  <div class="bg-white p-4 rounded-t-xl border-b border-gray-200 shadow-sm flex flex-col md:flex-row gap-4 justify-between items-center">
    
    <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
      
      <div class="relative w-full sm:w-80">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <i class="bi bi-search text-gray-400"></i>
        </div>
        <input type="text" [(ngModel)]="textoBusqueda" (keyup)="filtrar()" 
               class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-gray-50 placeholder-gray-500 focus:outline-none focus:bg-white focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition duration-150 ease-in-out" 
               placeholder="Buscar nombre, cédula o cargo...">
      </div>

      <div class="w-full sm:w-64">
        <select [(ngModel)]="filtroSucursal" (change)="filtrar()" 
                class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-lg bg-gray-50">
          <option value="">Todas las Sucursales</option>
          <option *ngFor="let suc of sucursales" [value]="suc.id">{{ suc.nombre }}</option>
        </select>
      </div>

    </div>
    
    <div class="text-sm text-gray-500 whitespace-nowrap">
      Mostrando <span class="font-bold text-gray-900">{{ empleadosFiltrados.length }}</span> colaboradores
    </div>
  </div>

  <div class="bg-white shadow-sm rounded-b-xl overflow-hidden border border-gray-200">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Empleado</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ubicación & Cargo</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Jornada & Ingreso</th>
            <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Rol Sistema</th>
            <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
            <th scope="col" class="relative px-6 py-3"><span class="sr-only">Acciones</span></th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          
          <tr *ngIf="loading">
            <td colspan="6" class="px-6 py-10 text-center text-gray-500">
              <div class="flex justify-center items-center gap-3">
                <span class="animate-spin h-5 w-5 border-2 border-indigo-500 border-t-transparent rounded-full"></span>
                Cargando directorio...
              </div>
            </td>
          </tr>

          <tr *ngIf="!loading && empleadosFiltrados.length === 0">
            <td colspan="6" class="px-6 py-10 text-center text-gray-500">
              <i class="bi bi-people text-4xl text-gray-300 mb-3 block"></i>
              <p class="mt-2">No se encontraron empleados con esos filtros.</p>
            </td>
          </tr>

          <tr *ngFor="let emp of empleadosFiltrados" class="hover:bg-gray-50 transition duration-150 group">
            
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center">
                <div class="flex-shrink-0 h-10 w-10">
                  <div class="h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold border border-indigo-200 group-hover:bg-indigo-200 transition">
                    {{ emp.nombres?.charAt(0) }}{{ emp.apellidos?.charAt(0) }}
                  </div>
                </div>
                <div class="ml-4">
                  <div class="text-sm font-bold text-gray-900">{{ emp.nombres }} {{ emp.apellidos }}</div>
                  <div class="text-xs text-gray-500 flex items-center gap-1">
                    <i class="bi bi-card-heading"></i> {{ emp.documento }}
                  </div>
                  <div class="text-xs text-indigo-600 mt-0.5">{{ emp.email }}</div>
                </div>
              </div>
            </td>

            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900 font-medium">{{ emp.nombre_puesto || 'Sin Cargo' }}</div>
              <div class="text-xs text-gray-500">{{ emp.nombre_departamento || 'General' }}</div>
              <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 mt-1">
                <i class="bi bi-building mr-1"></i> {{ emp.nombre_sucursal || 'Matriz' }}
              </span>
            </td>

            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900">
                <i class="bi bi-clock text-gray-400 mr-1"></i>
                {{ emp.nombre_turno || 'Sin Turno' }}
              </div>
              <div class="text-xs text-gray-500 mt-1">
                Ingreso: {{ emp.fecha_ingreso | date:'dd MMM yyyy' }}
              </div>
              <div *ngIf="emp.sueldo > 0" class="text-xs text-green-600 font-semibold mt-0.5">
                $ {{ emp.sueldo | number:'1.2-2' }}
              </div>
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-center">
              <span [ngClass]="{
                'bg-purple-100 text-purple-800 border-purple-200': emp.rol === 'ADMIN' || emp.rol === 'SUPERADMIN',
                'bg-blue-100 text-blue-800 border-blue-200': emp.rol === 'GERENTE',
                'bg-pink-100 text-pink-800 border-pink-200': emp.rol === 'RRHH',
                'bg-gray-100 text-gray-800 border-gray-200': emp.rol === 'EMPLEADO'
              }" class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full border">
                {{ emp.rol }}
              </span>
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-center">
              <button (click)="toggleEstado(emp)" 
                      [class]="emp.estado === 'ACTIVO' ? 'bg-green-100 text-green-800 border-green-200 hover:bg-green-200' : 'bg-red-100 text-red-800 border-red-200 hover:bg-red-200'"
                      class="px-3 py-1 rounded-full text-xs font-bold cursor-pointer transition border w-20">
                {{ emp.estado }}
              </button>
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
              <div class="flex justify-end gap-2">
                <button (click)="editarEmpleado(emp)" class="text-indigo-600 hover:text-indigo-900 bg-indigo-50 p-2 rounded-lg transition hover:bg-indigo-100 border border-transparent hover:border-indigo-200" title="Editar">
                  <i class="bi bi-pencil-square"></i>
                </button>
                <button (click)="verDetalles(emp)" class="text-gray-500 hover:text-gray-700 bg-gray-50 p-2 rounded-lg transition hover:bg-gray-100 border border-transparent hover:border-gray-200" title="Ver Ficha">
                  <i class="bi bi-eye"></i>
                </button>
              </div>
            </td>

          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="bg-gray-50 px-4 py-3 border-t border-gray-200 sm:px-6">
      <div class="flex items-center justify-between">
        <div class="text-xs text-gray-500">
          Mostrando {{ empleadosFiltrados.length }} registros
        </div>
      </div>
    </div>
  </div>
</div>