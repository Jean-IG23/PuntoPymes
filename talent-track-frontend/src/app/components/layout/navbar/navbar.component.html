<!-- NAVBAR PROFESIONAL Y UNIFICADO -->
<nav class="navbar-main">
  <div class="navbar-container">
    <!-- Lado Izquierdo: Logo y Navegación -->
    <div class="navbar-left">
      <!-- Logo -->
      <div class="logo-wrapper" (click)="goToHome()" role="button" tabindex="0">
        <div class="logo-icon">
          <i class="ri-bar-chart-2-line"></i>
        </div>
        <span class="logo-text">Talent<span class="logo-accent">Track</span></span>
      </div>

      <!-- Navegación Desktop -->
      <nav class="navbar-nav-desktop">
        <a routerLink="/home" 
           routerLinkActive="nav-link-active"
           [routerLinkActiveOptions]="{exact: true}"
           class="nav-link">
          <i class="ri-home-line"></i>
          <span>Inicio</span>
        </a>

        <a *ngIf="auth.canConfigCompany()" 
           routerLink="/organizacion"
           routerLinkActive="nav-link-active"
           class="nav-link">
          <i class="ri-building-line"></i>
          <span>Organización</span>
        </a>

        <a *ngIf="auth.isManagement()" 
           routerLink="/gestion/empleados"
           routerLinkActive="nav-link-active"
           class="nav-link">
          <i class="ri-team-line"></i>
          <span>Mi Equipo</span>
        </a>

        <a *ngIf="auth.isEmployee() || auth.isGerente()" 
           routerLink="/mi-perfil"
           routerLinkActive="nav-link-active"
           class="nav-link">
          <i class="ri-user-line"></i>
          <span>Mi Ficha</span>
        </a>
      </nav>
    </div>

    <!-- Lado Derecho: Notificaciones, Usuario y Acciones -->
    <div class="navbar-right">
      <!-- Notificaciones Desktop -->
      <button class="navbar-icon-btn" title="Notificaciones" *ngIf="user">
        <i class="ri-notification-3-line"></i>
        <span class="notification-badge" *ngIf="notificationCount > 0">{{ notificationCount }}</span>
      </button>

      <!-- Dropdown Usuario Desktop -->
      <div class="user-dropdown-wrapper" *ngIf="user">
        <button class="user-menu-btn" (click)="toggleUserDropdown()" title="Menú de usuario">
          <div class="user-avatar">
            {{ (user?.first_name || 'U').charAt(0).toUpperCase() }}
          </div>
          <div class="user-info">
            <span class="user-name">{{ user?.first_name || 'Usuario' }}</span>
            <span class="user-role">{{ auth.getRole() }}</span>
          </div>
          <i class="ri-arrow-down-s-line"></i>
        </button>

        <!-- Dropdown Menu -->
        <div class="user-dropdown-menu" *ngIf="userDropdownOpen" [@slideDown]>
          <div class="dropdown-header">
            <div class="user-avatar-large">
              {{ (user?.first_name || 'U').charAt(0).toUpperCase() }}
            </div>
            <div>
              <p class="dropdown-name">{{ user?.first_name }} {{ user?.last_name }}</p>
              <p class="dropdown-email">{{ user?.email }}</p>
            </div>
          </div>

          <div class="dropdown-divider"></div>

          <a href="#" (click)="goToProfile(); $event.preventDefault()" class="dropdown-item">
            <i class="ri-user-3-line"></i>
            <span>Mi Perfil</span>
          </a>

          <a href="#" class="dropdown-item" *ngIf="auth.isManagement()">
            <i class="ri-settings-line"></i>
            <span>Preferencias</span>
          </a>

          <div class="dropdown-divider"></div>

          <button (click)="logout()" class="dropdown-item danger">
            <i class="ri-logout-box-line"></i>
            <span>Cerrar Sesión</span>
          </button>
        </div>
      </div>

      <!-- Botón Login (si no está autenticado) -->
      <a *ngIf="!user" routerLink="/login" class="btn-login">
        <i class="ri-login-box-line"></i>
        <span>Iniciar Sesión</span>
      </a>

      <!-- Menu Móvil -->
      <button class="mobile-menu-btn" (click)="mobileMenuOpen = !mobileMenuOpen" title="Menú">
        <i class="ri-menu-line" *ngIf="!mobileMenuOpen"></i>
        <i class="ri-close-line" *ngIf="mobileMenuOpen"></i>
      </button>
    </div>
  </div>

  <!-- MENÚ MÓVIL EXPANDIBLE -->
  <div class="mobile-menu" *ngIf="mobileMenuOpen" [@slideDown]>
    <div class="mobile-menu-container">
      <!-- Perfil en Mobile -->
      <div class="mobile-user-section" *ngIf="user">
        <div class="mobile-user-card">
          <div class="user-avatar-mobile">
            {{ (user?.first_name || 'U').charAt(0).toUpperCase() }}
          </div>
          <div>
            <p class="mobile-user-name">{{ user?.first_name }}</p>
            <p class="mobile-user-role">{{ auth.getRole() }}</p>
          </div>
        </div>
        <hr class="mobile-divider">
      </div>

      <!-- Links de Navegación Mobile -->
      <a routerLink="/home" 
         (click)="closeMobileMenu()"
         routerLinkActive="mobile-nav-active"
         [routerLinkActiveOptions]="{exact: true}"
         class="mobile-nav-link">
        <i class="ri-home-line"></i>
        <span>Inicio</span>
      </a>

      <a *ngIf="auth.canConfigCompany()" 
         routerLink="/organizacion"
         (click)="closeMobileMenu()"
         routerLinkActive="mobile-nav-active"
         class="mobile-nav-link">
        <i class="ri-building-line"></i>
        <span>Organización</span>
      </a>

      <a *ngIf="auth.isManagement()" 
         routerLink="/gestion/empleados"
         (click)="closeMobileMenu()"
         routerLinkActive="mobile-nav-active"
         class="mobile-nav-link">
        <i class="ri-team-line"></i>
        <span>Mi Equipo</span>
      </a>

      <a *ngIf="auth.isEmployee() || auth.isGerente()" 
         routerLink="/mi-perfil"
         (click)="closeMobileMenu()"
         routerLinkActive="mobile-nav-active"
         class="mobile-nav-link">
        <i class="ri-user-line"></i>
        <span>Mi Ficha</span>
      </a>

      <hr class="mobile-divider">

      <!-- Notificaciones Mobile -->
      <button class="mobile-nav-link" *ngIf="user">
        <i class="ri-notification-3-line"></i>
        <span>Notificaciones</span>
        <span class="notification-badge-mobile" *ngIf="notificationCount > 0">{{ notificationCount }}</span>
      </button>

      <a routerLink="/mi-perfil" 
         (click)="closeMobileMenu()"
         class="mobile-nav-link">
        <i class="ri-user-3-line"></i>
        <span>Mi Perfil</span>
      </a>

      <hr class="mobile-divider" *ngIf="user">

      <!-- Logout Mobile -->
      <button *ngIf="user" (click)="logout(); closeMobileMenu()" class="mobile-nav-link danger">
        <i class="ri-logout-box-line"></i>
        <span>Cerrar Sesión</span>
      </button>

      <a *ngIf="!user" routerLink="/login" (click)="closeMobileMenu()" class="mobile-nav-link primary">
        <i class="ri-login-box-line"></i>
        <span>Iniciar Sesión</span>
      </a>
    </div>
  </div>
</nav>